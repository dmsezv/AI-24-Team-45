# Чекпоинт 5

## Введение

Базовой моделью выступила **YOLOv5m**, обученная на 28 эпохах.  
Начальные метрики:

- **mAP@0.5:** 34.9%
- **mAP@0.5:0.95:** 25.7%
- **Precision:** 40.8%
- **Recall:** 36.4%

Для улучшения результатов первым этапом была проведена обработка датасета.

## Обработка датасета

### Основные классы

1. bicycle
2. motorcycle
3. car
4. transporter (van)
5. bus
6. truck (others)
7. trailer _(отсутствует в датасете)_
8. unknown
9. mask

Классы **mask** и **unknown** размечены неполноценно, что негативно влияло на обучение.  
Были приняты следующие меры:

- **Закрашивание объектов этих классов чёрным.**
- **Удаление их аннотаций.**
- **Удаление изображений, содержащих только эти классы.**
- **Удаление класса trailer (7) за ненадобностью.**

### Балансировка данных

После очистки классы остались **неравномерно распределены**.  
Для ускоренной проверки гипотезы было отобрано **20 000 изображений**, с приоритетом на минорные классы:

- **90%** – классы с наименьшей представленностью.
- **10%** – случайный выбор из оставшегося датасета.

### Итоговое распределение

- **bicycle:** 1430
- **motorcycle:** 2559
- **car:** 129784
- **transporter (van):** 17270
- **bus:** 12555
- **truck:** 1185

Балансировка позволила увеличить количество **transporter (van)**, изначально детектируемого YOLO как **car**, что даёт возможность обучить модель правильно различать этот класс.

## Обучение модели

Выбрана **YOLOv12m** как оптимальный баланс между точностью и скоростью.

### Метрики до обучения

- **mAP@0.5:** 15.7%
- **mAP@0.5:0.95:** 10.8%
- **Precision:** 30.0%
- **Recall:** 23.8%

Модель некорректно детектировала некоторые классы.

### Итоговые метрики

- **mAP@0.5:** 54.5%
- **mAP@0.5:0.95:** 42.2%

## Выводы по обучению

### Улучшения

- **mAP@0.5 увеличился с 15.7% до 54.5%.**
- **mAP@0.5:0.95 вырос с 10.8% до 42.2%.**

### Проблемы с "bicycle" и "motorcycle"

- **Объекты слишком малы, YOLO плохо их детектирует на imgsz=640.**
- **Возможные решения:**
  - Увеличение разрешения изображений.
  - Настройка Confidence Threshold и Intersection Over Union Threshold.
  - Добавление данных с минорными классами.

### Успешное обучение класса "transporter (van)"

- **mAP@0.5 для transporter (van) достиг 80.6%, а mAP@0.5:0.95 – 65.7%.**
- **Результат получен всего за 30 эпох на урезанном датасете.**

## Общие выводы

После обучения на **очищенном и сбалансированном датасете** удалось значительно повысить качество детекции.

### Следующие шаги:

- **Оптимизация детекции мелких объектов ("bicycle", "motorcycle").**
- **Расширение датасета для повышения качества модели.**
- **Продолжение обучения на большем количестве эпох.**
