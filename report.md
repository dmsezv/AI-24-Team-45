# Инструкция по сборке контейнеров c backend и frontend приложениями

1. **Убедитесь, что у вас установлен Docker**: Перед началом работы убедитесь, что Docker установлен и запущен на вашем компьютере.

2. **Перейдите в корневую директорию проекта**: Перейдите в директорию, где находится файл `docker-compose.yml`.

3. **Соберите контейнеры c backend и frontend приложениями**: Используйте команду `ENVIRONMENT=debug docker-compose up --build` для сборки контейнеров. Эта команда прочитает инструкции из `docker-compose.yml`, выберет правильный .env файл и создаст необходимые образы Docker.

4. **Запустите контейнеры**: После успешной сборки контейнеров, запустите их с помощью команды `docker-compose up`. Эта команда запустит все сервисы, определенные в `docker-compose.yml`.

5. **Проверьте работу сервисов**: Убедитесь, что все сервисы запущены корректно. Вы можете проверить логи с помощью команды `docker-compose logs`.

6. **Проверьте работу приложения**: Перейдите в браузер и откройте страницу `http://localhost:8501`. Если все сделано правильно, вы увидите Streamlit приложение.

<br/>

# Структура проекта

Проект состоит из следующих основных компонентов:

- **app/**: Главная директория проекта, содержащая исходный код.
  - **backend/**: Директория с кодом серверной части приложения (fastapi).
    - **app_models/**: Модели данных для backend.
    - **app_utils/**: Утилиты и вспомогательные функции для backend.
    - **logs/**: Логи работы backend.
    - **routers/**: Директория с роутерами для обработки API-запросов.
    - **config.py**: Загружает переменные окружения из файла `.env.*`.
    - **main.py**: Главный файл для запуска backend.
    - **requirements.txt**: Зависимости для backend.
    - **Dockerfile**: Dockerfile для сборки образа backend.
  - **frontend/**: Директория с кодом клиентской части приложения (streamlit).
    - **assets/**: Статические файлы и ресурсы для frontend.
    - **logs/**: Логи работы frontend.
    - **pages/**: Страницы Streamlit приложения.
    - **public/**: Публичные файлы для frontend.
    - **settings/**: Конфигурационные файлы для frontend.
      - **config.py**: Загружает переменные окружения из файла `.env.*`
      - **logging_config.py**: Настройки логирования.
    - **streamlit_app.py**: Главный файл для запуска Streamlit приложения.
    - **requirements.txt**: Зависимости для frontend.
    - **Dockerfile**: Dockerfile для сборки образа frontend.
  - **pycodestyle.py**: Файл для проверки кода с помощью pylint и flake8.
- **docker-compose.yml**: Файл для управления контейнерами Docker.
- **model/**: Директория для хранения моделей.
- **images/**: Директория для хранения изображений.
- **description/**: Директория для хранения описаний и документации.
- **requirements.txt**: Зависимости для проекта для локальной разработки.
- **README.md**: Основная документация проекта.

<br/>

# Описание backend приложения (FastAPI)

Приложение содержит следующие ручки:

## Роутеры для детекции (/detect)

1. **POST /detect/coordinates**:

   - **Описание**: Обнаруживает координаты транспортных средств на загруженном изображении.
   - **Вход**: Файл изображения.
   - **Выход**: Список объектов `DetectionResult` с координатами.

2. **POST /detect/image**:
   - **Описание**: Обнаруживает транспортные средства на загруженном изображении и возвращает изображение с нарисованными рамками.
   - **Вход**: Файл изображения.
   - **Выход**: Изображение с нарисованными рамками в формате JPEG.

## Роутеры для моделей (/models)

1. **POST /models/set_model**:

   - **Описание**: Устанавливает модель для детекции.
   - **Вход**: Имя модели.
   - **Выход**: Сообщение об успешной установке модели.

2. **GET /models/available**:

   - **Описание**: Возвращает список доступных моделей.
   - **Выход**: Список доступных моделей.

3. **GET /models/current**:
   - **Описание**: Возвращает имя текущей модели.
   - **Выход**: Имя текущей модели.

<br/>

# Описание клиентской части (Streamlit)

- **streamlit_app.py**:

  - **Назначение**: Главный файл для запуска Streamlit приложения.
  - **Основные функции**:
    - Загружает доступные модели и текущую модель с сервера.
    - Позволяет пользователю выбрать модель из списка и обновить её на сервере.
    - Содержит навигацию по страницам приложения, таким как "Detect Image", "Get Coordinates", "EDA", "Training Progress", и "Fit".

- **Страницы**:
  - **Detect Image**: Страница для загрузки изображений и выполнения детекции объектов.
  - **Get Coordinates**: Страница для получения координат объектов на изображении.
  - **EDA**: Страница для отображения разведочного анализа данных.
  - **Training Progress**: Страница для отображения метрик обученой модели.
  - **Fit**: Страница для обучения модели.

<br/>

# Описание линтера (pycodestyle.py)

- **Назначение**: Выполняет проверку кода с помощью инструментов `flake8` и `pylint`.
- **Основные функции**:

  - `run_flake8(script_path)`: Запускает `flake8` для проверки стиля кода в указанном скрипте. Использует максимальную длину строки 120 символов.
  - `run_pylint(script_path)`: Запускает `pylint` для статического анализа кода в указанном скрипте. Игнорирует некоторые предупреждения и ошибки, такие как `C0103`, `C0114`, `C0115`, и `cv2.*`.
  - `run_linters(script_path)`: Запускает обе проверки (`flake8` и `pylint`) для указанного скрипта.

- **Использование**:
  - Запустите скрипт с помощью команды `python pycodestyle.py <your_script.py>`, чтобы проверить указанный файл.
